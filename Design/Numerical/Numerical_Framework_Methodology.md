# 🧙‍♂️ 游戏数值框架构建指南 (Numerical Framework Construction Guide)

> **"数值不是数学题，而是体验的翻译官。"**
>
> 很多新手设计师一上来就纠结“防御力公式用减法还是除法”，这是战术层面的细节。**数值框架 (Framework)** 是战略层面的顶层设计，它决定了游戏能玩多久、爽感来源以及付费深度。

---

## 📚 1. 理论基础 (Theoretical Basis)

### 🏗️ 数值架构的三条腿 (The Three Pillars)
构建任何游戏的数值框架，都需要先确定这三个核心维度：

1.  **战斗数值 (Combat):** 决定单局内的爽感。核心指标是 **TTK (Time to Kill)**。
2.  **经济数值 (Economy):** 决定资源的产出与消耗循环。核心指标是 **购买力 (Purchasing Power)**。
3.  **成长数值 (Progression):** 决定游戏的寿命。核心指标是 **成长曲线 (Power Curve)**。

### 📈 膨胀模型的选择 (Inflation Models)
你希望玩家的属性怎么涨？

*   **线性模型 (Linear):** `Level * 10`。
    *   *优点:* 易于控制，PVP 平衡好做。
    *   *缺点:* 后期无聊，升级带来的爽感递减（10对100提升很大，10对10000无感）。
    *   *适用:* 传统 FPS, MOBA, 竞技 RTS。
*   **指数模型 (Exponential):** `Base * (1.1 ^ Level)`。
    *   *优点:* 永远有爽感，每升一级都是质变。
    *   *缺点:* 极易崩坏，后期数字如果不压缩会变成 `1aa, 1bb`。
    *   *适用:* Diablo, 放置游戏, 卡牌 RPG。
*   **分段模型 (Bounded):**
    *   *适用:* 我们的 **Vampirefall**。塔防部分相对克制（确保策略有效），肉鸽部分允许指数爆发（确保爽感）。

---

## 🛠️ 2. 实践应用 (Practical Implementation)

### 🪜 第一步：确立“锚点” (Define the Anchors)
不要凭空捏造数字。你需要一个基准单位。

*   **标准单位 (Standard Unit):** 比如“1级步兵”。
    *   生命值 (HP): **100** (方便心算百分比)。
    *   攻击力 (ATK): **10**。
    *   攻击速度 (ASP): **1.0** (每秒1刀)。
*   **推导 TTK:**
    *   `100 HP / 10 DPS = 10秒`。
    *   这就是你的**基准战斗节奏**。如果此时感觉怪死太慢，就调整 HP 或 ATK，而不是改公式。

### ⚗️ 第二步：选择战斗公式 (Combat Formulas)
这是数值框架的“引擎”。

1.  **减法公式 (Subtraction):** `Damage = Atk - Def`
    *   *特点:* **破防**机制带来极致快感。如果不破防就是 1 点伤害。
    *   *风险:* 极其敏感。防御力增加 1 点可能导致受击伤害直接减半。
    *   *Vampirefall 策略:* **慎用**。或者不仅用于护盾系统。
2.  **乘除法公式 (Multiplication/Division):** `Damage = Atk * (1 - DefReduction%)`
    *   通常 `DefReduction% = Def / (Def + Constant)` (如 LOL/王者荣耀)。
    *   *特点:* 收益平滑，不会出现不破防的情况。
    *   *风险:* 堆防御有边际效应递减。
    *   *Vampirefall 策略:* **主要采用**。因为塔防怪海需要稳定的伤害预期。

### 🌳 第三步：铺设成长线 (Progression Curve)
使用 Excel 模拟玩家在不同等级的标准属性。

**Vampirefall 标准模型表 (示例):**

| 等级 (Lv) | 标准生命 (HP) | 标准攻击 (ATK) | 升级倍率 (Rate) | 预计游戏时长 (Hour) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 100 | 10 | 1.0 | 0.5 |
| 10 | 500 | 50 | 1.2 | 5.0 |
| 50 | 5000 | 500 | 1.5 | 20.0 |
| 100 | 500000 | 5000 | 2.0 | 100.0 |

*   *注意:* 在 50级后开始引入指数膨胀，以维持后期作为“割草游戏”的爽感。

### 🎮 Unity 数据结构设计
不要把数值写死在代码里。

```csharp
[System.Serializable]
public struct CombatStats
{
    public float BaseHP; // 基础生命
    public float BaseAtk; // 基础攻击
    
    // 成长系数，通常从配置表读取
    public float GrowthMetrics; 

    public float GetHP(int level)
    {
        // 混合成长公式：线性基底 + 指数修正
        return BaseHP * level * Mathf.Pow(1.05f, level);
    }
}
```

---

## 🌟 3. 业界优秀案例 (Industry Best Practices)

### 🏰 Kingdom Rush (皇家守卫军)
*   **框架:** 极简的**小数值**体系。
*   **特点:** 攻击力是个位数到两位数。
*   **优点:** 策略极度清晰。3级箭塔攻击力 10-15，哥布林血量 30，玩家一眼就知道大概要射 2-3 下。
*   **借鉴:** 塔防部分应保持这种清晰度。

### 🗡️ Diablo III (暗黑破坏神3)
*   **框架:** 极度夸张的**指数膨胀**。
*   **特点:** 满级后有了套装，伤害直接放大 50000%。
*   **优点:** 刷装备的动力极强。
*   **缺点:** 数字太大变成了“兆/京”，失去了实感。
*   **借鉴:** Vampirefall 的 Roguelike 局内成长可以参考，但要控制上限。

### ⚔️ Elden Ring (艾尔登法环)
*   **框架:** **软上限 (Soft Cap)** 机制。
*   **特点:** 力量从 10 加到 40 收益很高，40 到 60 收益变低，80 以上几乎没收益。
*   **优点:** 防止单一属性造神，鼓励多修（水桶号）。

---

## 🔗 4. 参考资料 (References)
*   📄 **[Numerical Manual](../Numerical_Manual.md):** 本项目的具体数值设定。
*   📄 **[Power Creep Management](../Systems/Power_Creep_Management.md):** 如何防止数值崩坏。
*   🌐 **GDKeys:** 著名的游戏数值设计博客。

---

## 🔬 5. 小数值 vs 大数值：心理学与机制的博弈

数值的大小不仅仅是数学问题，更是**心理学 (Player Psychology)** 和 **系统设计 (System Design)** 的核心决策。

### 🐁 小数值 (Small Numbers)
> **代表作:** Kingdom Rush, 炉石传说, 杀戮尖塔, 龙与地下城 (D&D)

#### 1. 心理学效应：确定性 (Determinism)
*   **可预测性高:** 当一个怪 10 HP，你打 3 伤害。你的大脑瞬间算出：“我要打 4 下”。
*   **计算零负担:** 玩家不需要把鼠标悬停在怪身上看详细数据，仅仅通过血条的一格一格就能预判战局。
*   **策略反馈感强:** “+1 攻击力”在小数值系统里是**质变**（从打4下变成打3下）。玩家会极其珍惜每一个增益。

#### 2. 系统设计优势
*   **平衡好做:** 策划可以通过枚举法算尽所有情况。
*   **Bug 易查:** 伤害异常一眼就能看出来。

#### 3. 致命缺陷：成长感缺失 (The Trap)
*   **瓶颈来得快:** 1级攻击力是 10，100级攻击力如果是 20，玩家会觉得这 100 级白练了。如果是 1000，那初期的怪就是纸糊的。小数值很难支撑**长线 RPG**。
*   **细分困难:** 很难设计“1.5% 暴击率”这种词条，因为基数太小，乘出来是小数。

### 🐘 大数值 (Big Numbers)
> **代表作:** 魔兽世界, 暗黑破坏神3/4, 放置类游戏 (Cookie Clicker), 绝大多数国产 MMO

#### 1. 心理学效应：多巴胺轰炸 (Dopamine Rush)
*   **视觉冲击:** 屏幕上跳出一个 `999,999` 的暴击大红字，会直接刺激大脑的多巴胺分泌。
*   **成长错觉:** 哪怕只是单纯的通货膨胀（怪血量加倍，你伤害加倍），玩家也会觉得“我变强了”。
*   **模糊计算:** 玩家放弃计算，只凭感觉。“反正我伤害很高，A过去就完了”。适合**割草**体验。

#### 2. 系统设计优势
*   **设计空间无限:** 可以在 100 到 1000 万之间随意插入装备档位。
*   **微小提升有意义:** 可以在数值后面加很多零头，方便通过算法自动投放大量垃圾装备作为过渡。
*   **兼容性:** 哪怕数值崩坏了，只要加个“K, M, B, T” (千, 百万, 十亿) 的后缀单位，玩家依然能玩。

#### 3. 致命缺陷：数字脱敏 (Numbness)
*   **变成乱码:** 当攻击力变成 `4.2e18` 时，它就不再代表力量，只是一个无意义的字符串。玩家会完全麻木。
*   **策略失效:** 玩家无法预判“这刀下去怪会不会死”，只能疯狂堆 DPS。

### ⚖️ 本项目的抉择：混合策略 (Hybrid Strategy)

**Vampirefall 不走极端，而是采用分层设计：**

1.  **防御塔 (小数值):** 保持个位数/两位数的攻击力。
    *   *理由:* 塔防是策略核心，玩家必须能心算塔的效率。
2.  **词条倍率 (中数值):** 暴击率、冷却缩减用百分比（如 15%）。
    *   *理由:* 符合通用认知。
3.  **最终伤害 (大数值):** 通过频率放大。
    *   *理由:* 虽然塔单发伤害低 (20点)，但攻速快 (5.0) + 多重射击 (x3) + 暴击 (x2)，最终每秒跳出的总伤可以是几百上千。
    *   **结果:** **“思考时很清晰 (小数值)，战斗时很爽 (大数值)。”**

    *   **结果:** **“思考时很清晰 (小数值)，战斗时很爽 (大数值)。”**

---

## 🌪️ 6. 头脑风暴：小数值 vs 大数值 50 问 (The 50 Points List)

为了辅助决策及作为未来面试/设计的谈资，这里列举了详细的优点（✅）与缺点（❌），涵盖设计、程序、美术、运营四个维度。

### 🐁 小数值 (Small Numbers) - 比如 Mario, Hearthstone
**👍 优点 (Pros)**
1.  **✅ [设计] 心算友好:** 玩家看到 `3` 攻击打 `10` 血，立刻得出“打4下”的结论。
2.  **✅ [设计] 每一个点都珍贵:** 攻击力从 1 变成 2 是 **100% 的提升**，玩家狂喜。
3.  **✅ [UI] 排版美观:** 永远不需要缩写 `K/M/B`，界面整洁，不会溢出文本框。
4.  **✅ [程序] 永远不溢出:** `int8/byte` 甚至都能存，永远不用担心 `long` 够不够用。
5.  **✅ [平衡] 穷举法可行:** 只有 1~10 攻，策划可以用 Excel 甚至手写列出所有组合，确保无必胜解。
6.  **✅ [策略] 容易做减法公式:** `Atk - Def` 也可以用得很溜，因为数值可控。
7.  **✅ [PvP] 竞技公平感:** 小数值让人觉得是“智商的比拼”而不是“谁充钱多”。
8.  **✅ [教程] 学习成本低:** 新手教程里 `1+1=2` 谁都懂。
9.  **✅ [复盘] 容易归因:** 输了知道是“少打了一下”，而不是“对面数值太高”。
10. **✅ [美术] 血条刻度清晰:** 可以真的画 10 个格子代表 10 HP，视觉反馈极度直观。
11. **✅ [音效] 打击感匹配:** 没下攻击都很重，音效可以做得很有“分量”。
12. **✅ [运营] 通货膨胀慢:** 没法发“全服赠送100万金币”，经济系统崩得慢。
13. **✅ [心理] 掌控感:** 玩家觉得自己完全看透了游戏机制。
14. **✅ [开发] 测试快:** 不用测“攻击力溢出”的极值情况。
15. **✅ [关卡] 怪物复用性高:** 一个 5 攻的哥布林，到了后期换个颜色还能当小怪用。
16. **✅ [服务器] 包体小:** 序列化数据极小。
17. **✅ [客户端] 不需要浮点:** 避免了浮点数精度误差问题。
18. **✅ [本地化] 语言无关:** 阿拉伯数字全球通用，不用翻译“万/亿/兆”。
19. **✅ [节奏] 战斗清晰:** 只要看懂一下，就能看懂整场战斗。
20. **✅ [成就感] 智力碾压:** 赢了觉得是自己聪明。

**👎 缺点 (Cons)**
1.  **❌ [成长] 升级无感:** 升一级加 0.1 攻？感觉没加一样。
2.  **❌ [奖励] 缺乏细分:** 很难通过“每日签到”给玩家发“0.5个金币”。
3.  **❌ [付费] 挖坑浅:** 很难卖“强化+10”的道具，因为+10就无敌了。
4.  **❌ [战斗] 缺乏爽感:** 没有满屏飙红字的快感。
5.  **❌ [容错] 极低:** 配置错 1 点数值可能导致关卡完全打不过。
6.  **❌ [公式] 必须四舍五入:** `3.5` 的伤害如果不显示小数，玩家会困惑。
7.  **❌ [多样性] 装备难做:** 很难通过装备区分出 1.25 和 1.26 的区别。

### 🐘 大数值 (Big Numbers) - 比如 Diablo, WoW
**👍 优点 (Pros)**
1.  **✅ [心理] 爽！:** 看到 `999999` 暴击，本能的肾上腺素飙升。
2.  **✅ [成长] 升级感强:** 每升一级都在变强，哪怕只是数字变大。
3.  **✅ [设计] 容错率高:** 策划填错 100 点攻击力？无所谓，反正玩家有 100 万血。
4.  **✅ [运营] 活动好做:** “全服赠送 88888 钻石”，听起来比“送1个钻石”大气多了。
5.  **✅ [付费] 挖坑深:** 可以设计“强化+1”到“强化+100”，因为数值空间够大。
6.  **✅ [装备] 垃圾回收:** 可以产出大量细微差异的垃圾装备，延长游戏时长。
7.  **✅ [公式] 兼容性强:** 乘法、指数随便用，不用担心变成 0。
8.  **✅ [视觉] 填满屏幕:** 满屏的伤害数字本身就是一种特效。
9.  **✅ [社交] 炫耀资本:** “我战力 500 万”比“我战力 50”听起来牛逼。
10. **✅ [随机] 适合 Roguelike:** 可以接受 +500% 这种夸张的词条。
11. **✅ [回血] 吸血爽:** 一刀下去吸回一管血。
12. **✅ [经济] 回收手段多:** 修理费、手续费可以定很高。
13. **✅ [挂机] 适合放置:** 离线收益随着时间指数增长。
14. **✅ [更新] 资料片好做:** 新资料片直接把数值翻倍，玩家甚至不用重新学机制。
15. **✅ [新手] 挫败感低:** 反正看不懂，哪里亮了点哪里。
16. **✅ [生态] 搬砖党:** 方便工作室打金（虽然这是双刃剑）。
17. **✅ [系统] 宠物/翅膀:** 可以加很多不影响核心平衡但能卖钱的系统。
18. **✅ [反馈] 连续性:** 伤害是像水流一样连续输出的，而不是断点。
19. **✅ [留存] 沉没成本:** 练到几百万战力，玩家舍不得弃坑。
20. **✅ [心理] 力量幻想:** 满足玩家想当“神”的幻想。

**👎 缺点 (Cons)**
1.  **❌ [UI] 排版灾难:** `1.24aa`, `1241512` 经常挤爆 UI 框。
2.  **❌ [程序] 大数库性能:** 需要引入 `BigInteger` 库，计算比 `int` 慢 10 倍以上 (GC 问题)。
3.  **❌ [理解] 门槛高:** 后期玩家对数字麻木，不知道自己到底强不强。
4.  **❌ [PVP] 秒杀:** 只要数值高一点点，就是直接秒杀，毫无操作可言。
5.  **❌ [服务器] 存储压力:** 需要更多字节存数据。
6.  **❌ [本地化] 单位混乱:** 中文万/亿，英文 K/M/B，日文万/亿，换算极其头疼。
7.  **❌ [Bug] 溢出崩溃:** 很容易达到 float 上限变成 Infinity 或 NaN，导致游戏崩溃。
8.  **❌ [美术] 光污染:** 为了匹配大数值，特效通常会做得很闪，眼睛疼。

---

## 🦄 7. 案例解剖：暗黑破坏神的“京”级伤害来源

为什么 Diablo 3/4 的伤害能轻松突破 **万亿 (Trillion)**？因为所有增伤都是**独立乘区 (Separate Multipliers)**。

### 🧬 伤害公式 (The Formula)

> **Final Dmg = Base * (MainStat%) * (Crit%) * (Skill%) * (Set%) * (Legendary%) * (Vuln%)**

让我们算一笔账：

1.  **基础伤害 (Base):** 武器伤害 `2,000`。
2.  **主属性 (Main Stat):** 10,000 点力量 = 增伤 `+10,000%` (x100)。
    *   *Result:* 200,000
3.  **暴击伤害 (Crit Dmg):** 500% 爆伤 = `x5`。
    *   *Result:* 1,000,000 (一百万)
4.  **技能倍率 (Skill):** 强力技能倍率 800% = `x8`。
    *   *Result:* 8,000,000 (八百万)
5.  **套装效果 (Set Bonus):** “XX套装：你的冰霜伤害提高 10,000%” = `x100`。
    *   *Result:* 800,000,000 (八亿)
6.  **传奇宝石/被动 (Legendary):** 困者之灾、全能法戒等 3 个独立增伤，每个 x1.5 = `x3.375`。
    *   *Result:* 2,700,000,000 (二十七亿)
7.  **易伤/歧视伤 (Vulnerability):** 对精英怪伤害 +50% = `x1.5`。
    *   *Result:* **4,050,000,000 (四十亿)**

**结论:** 只要有 **4-5 个相互独立的乘法因子**，数值就会像核裂变一样指数爆炸。Vampirefall 要小心控制“独立乘区”的数量。


---

## 🃏 8. 案例解剖：杀戮尖塔 (Slay the Spire) 的精密计算

与暗黑相反，STS 是**小数值**的巅峰。它的伤害公式极其克制，但策略深度极深。

### 🧬 伤害公式 (The Formula)

> **Final Dmg = (Base + Strength) * (Vulnerable 1.5) * (Stance 2.0)**

让我们看看同样是一次“爆发”：
1.  **基础伤害 (Base):** `打击` 牌造成 **6** 点伤害。
2.  **力量属性 (Strength):** 哪怕你甚至叠了 **4** 点力量（这已经很高了）。
    *   *Result:* 6 + 4 = **10**
3.  **易伤状态 (Vulnerable):** 敌人受到的伤害 +50%。这是游戏中为数不多的乘区。
    *   *Result:* 10 * 1.5 = **15** (取整)
4.  **愤怒姿态 (Stance - Wrath):** (观者职业) 造成双倍伤害。
    *   *Result:* 15 * 2.0 = **30**

### 🧠 为什么 30 点伤害也很爽？
*   **因为它是确定的:** 敌人头顶显示“意图：攻击 28”。
*   **生死一线:** 你打出 30 伤害把怪打死，和你打出 25 伤害被怪打死，是**生与死**的区别。
*   **结论:** 在小数值系统中，爽感不来自于数值的大小，而来自于**“刚好够用”的解题成就感**。

---

## 🏹 9. 案例解剖：弓箭传说 (Archero) 的混合艺术

弓箭传说展示了如何把小数值和大数值结合。它拥有肉鸽的“随机乘积”，但又不像 Diablo 那么失控。

### 🧬 核心机制：基础攻击力 (Attack) vs 进场增益 (In-Game Buff)

*   **局外成长 (Linear):** 装备提供的攻击力是**线性叠加**的。
    *   武器: +100
    *   戒指: +50
    *   天赋: +20
    *   *Total Base:* 170。这是玩家进场前的“锚点”。

*   **局内成长 (Exponential):** 进场后的 Buff 是**乘算**的。
    *   **连射 (Multishot):** 输出翻倍 (x2)，但单发伤害 -15% (x0.85) -> `x1.7`。
    *   **正向箭 (Front Arrow):** 箭矢数量 +1 (x2)，但单发伤害 -25% (x0.75) -> `x1.5`。
    *   **攻击强化 (Attack Boost):** 基础攻击力 +30% -> `x1.3`。

### 📉 伤害模拟
假设基础攻击力 1000：

1.  **初始状态:** 1000 DPS。
2.  **拿到[连射]:** 1000 * 1.7 = 1700 DPS。
3.  **拿到[正向箭]:** 1700 * 1.5 = 2550 DPS。
4.  **拿到[大攻]:** 2550 * 1.3 = 3315 DPS。

**分析:**
*   **可控的膨胀:** 弓箭传说的乘区很少，主要是“箭矢数量”和“攻击力加成”。
*   **视觉爽感:** 它的爽感主要来自于**屏幕上的箭矢数量变多 (弹幕密度)**，而不仅仅是跳出的数字变大。
*   **Vampirefall 启示:** **“视觉密度膨胀”** 是比 **“数值膨胀”** 更健康的爽感来源。让满屏都是特效，比让怪物头顶跳出一个 `1亿` 更好。

---

## 🥔 10. 案例解剖：土豆兄弟 (Brotato) 的加法美学

Brotato 走出了第三条路：**基础属性流 (Flat Stat Scaling)**。它的数值膨胀非常平滑，且让“垃圾属性”变得极其珍贵。

### 🧬 伤害公式 (The Formula)

> **Final Dmg = [WeaponBase + (FlatStat * Ratio)] * (1 + Dmg%) * (CritMultiplier)**

这与 Diablo 的全乘法不同，它是典型的**先加后乘**逻辑。

#### 🧪 机制核心：Scaling Ratio (属性加成系数)
每一把武器对基础属性的利用率是不同的。

*   **冲锋枪 (SMG):**
    *   Base Dmg: 3
    *   Scaling: **50%** 远程伤害 (Ranged Dmg)。
*   **火箭筒 (Nuclear):**
    *   Base Dmg: 80
    *   Scaling: **150%** 元素伤害 (Elemental Dmg)。

#### 📉 场景模拟：获得 +10 点属性
假设你获得了一个道具：“+10 远程伤害”。

1.  **如果你拿的是冲锋枪:**
    *   基础伤害从 3 变成了 `3 + (10 * 0.5) = 8`。
    *   **提升幅度:** `(8-3)/3` = **166%**。
    *   *结论:* 对低伤高频武器，固定数值提升是神技。

2.  **如果你拿的是狙击枪 (假设 Base 50, Scaling 100%):**
    *   基础伤害从 50 变成了 `50 + (10 * 1.0) = 60`。
    *   **提升幅度:** `(60-50)/50` = **20%**。
    *   *结论:* 由于攻速慢，这 10 点伤害的 DPS 转化率极低。

### 🧠 Vampirefall 借鉴点
1.  **让“攻击力+1”变得有趣:** 不要让所有塔都无脑吃攻击力。
    *   **加农炮:** 吃 300% 的攻击力加成（鼓励堆攻击）。
    *   **激光塔:** 只吃 10% 的攻击力加成，但吃 500% 的攻速加成（鼓励堆攻速）。
2.  **负属性博弈 (Trade-offs):** Brotato 经常有 “+15% 伤害，-5 护甲” 的道具。由于公式里伤害加成是 `(1 + Total%)`，当你有 +200% 伤害时，扣 15% 根本不痛不痒，但减护甲可能致命。这促使玩家权衡属性的**边际效益**。


