# 🏰 塔防建筑机制设计 (Tower Defense Mechanics)

本文档详细定义了 Project Vampirefall 中“塔防”部分的玩法规则。由于本作混合了 ARPG 元素，塔的设计必须考虑到与主角的协同作战。

---

## 1. 核心设计原则 (Core Principles)

1.  **主角是矛，塔是盾 (Hero is Spear, Tower is Shield):**
    *   主角负责爆发输出、切后排、处理高威胁目标。
    *   塔负责阵地维持、清理杂兵 (AoE)、提供控制 (CC)。
2.  **动态阵地 (Dynamic Positioning):**
    *   不同于传统塔防的固定路线，本作可能涉及开放地形。塔的放置不仅为了输出，更是为了**改变怪物寻路 (Maze Building)**。
3.  **资源循环 (Resource Loop):**
    *   造塔资源来自于杀怪（直接掉落或连击奖励），鼓励积极战斗而非挂机。

---

## 2. 塔的生命周期 (Lifecycle)

### 2.1 建造 (Construction)
*   **消耗:** **废料 (Scrap)**。这是局内临时资源，与金币不同，每局重置。
*   **条件:** 必须在“能量格 (Power Grid)”范围内，或者主角周围一定范围内。
*   **时间:** 瞬时建造，但在 2秒 内处于“部署状态”（脆弱、不攻击）。
*   **限制:** 基于“人口/核心算力”限制总量，防止堆砌。

### 2.2 仇恨与耐久 (Aggro & Health)
*   **可被攻击:** 怪物**会**攻击塔。
*   **仇恨逻辑:**
    *   若路被堵死，怪物会攻击阻挡它的塔（破墙机制）。
    *   远程怪物会优先攻击射程内的防御塔。
    *   *特殊:* 某些“幽灵”类怪物穿墙，无视碰撞。
*   **维修:** 主角靠近塔时，按交互键消耗少量 Scraps 进行维修。

### 2.3 升级与变异 (Upgrade & Morph)
*   **Tier 1 -> Tier 3:** 基础数值提升（射程、伤害）。
*   **Tier 4 (变异):** 必须选择分支。
    *   *示例:* `箭塔` -> `多重射击塔` (物理AoE) 或 `狙击塔` (单体高伤)。

### 2.4 拆除 (Salvage)
*   返还 50% 资源。
*   用于应对战线推进，将后方的废弃塔拆除回收资源。

---

## 3. 塔的分类 (Tower Types)

### 3.1 物理系 (Kinetic) - *高单体，破甲*
*   **弩炮 (Ballista):** 基础单体，高射速。
    *   *被动:* 连续攻击同一目标伤害递增。
*   **重炮 (Cannon):** 抛物线攻击，小范围爆炸。
    *   *特性:* 对护盾 (Shield) 伤害减半，对护甲 (Armor) 伤害加倍。

### 3.2 魔法系 (Arcane) - *控制，穿透*
*   **水晶塔 (Prism):** 激光攻击，穿透直线上所有敌人。
    *   *特性:* 攻击无视护甲。
*   **减速力场 (Slow Field):** 无伤害，降低范围内敌人 30% 移速。
    *   *进阶:* 几率冻结敌人。

### 3.3 辅助系 (Support) - *Buff，资源*
*   **增幅器 (Amplifier):** 自身不攻击，连接周围 2 个塔，增加其攻速。
*   **回收站 (Recycler):** 范围内怪物死亡多掉落 10% Scrap。

---

## 4. 塔与主角的交互 (Synergy)

这是本作区别于传统塔防的关键：

1.  **过载 (Overcharge):**
    *   主角技能。消耗主角法力，使目标塔在 5秒 内攻速翻倍，但随后瘫痪 3秒。
2.  **属性赋予 (Imbuing):**
    *   主角的武器附魔会影响附近的塔。
    *   *例:* 主角武器附带“火焰伤害”，周围的物理塔攻击也会附加灼烧。
3.  **战术掩体:**
    *   塔可以阻挡敌人的飞行道具，主角可以秦王绕柱，利用塔作为掩体规避伤害。

---

## 5. 数据结构参考 (Data Structure Specs)

```json
{
  "tower_id": "T_Ballista_01",
  "name": "Iron Ballista",
  "cost": 100,
  "stats": {
    "damage_min": 20,
    "damage_max": 35,
    "attack_rate": 1.5,
    "range": 8.0,
    "health": 500
  },
  "tags": ["Physical", "Projectile", "Ground_Target"],
  "upgrade_path": ["T_Ballista_02", "T_MultiShot_01"]
}
```
