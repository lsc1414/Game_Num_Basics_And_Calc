# ğŸ§™â€â™‚ï¸ æ„å»ºã€Šæ€æˆ®å°–å¡”ã€‹ç±»æ¸¸æˆçŸ¥è¯†å›¾è°± (The Knowledge Map of Slay the Spire)

è¿™ä»½æ–‡æ¡£æ—¨åœ¨æ‹†è§£ Rogue-like Deckbuilder (DBG) æ¸¸æˆçš„æ ¸å¿ƒè®¾è®¡çŸ¥è¯†ä½“ç³»ï¼Œä»æ•°å­¦æ¨¡å‹åˆ°ä»£ç æ¶æ„ï¼Œä¸º Vampirefall é¡¹ç›®æä¾›ç†è®ºæ”¯æ’‘ã€‚

## ğŸ“š 1. ç†è®ºåŸºç¡€ (Theoretical Basis)

### 1.1 æ ¸å¿ƒå®šä¹‰ï¼šä»€ä¹ˆæ˜¯ Roguelike DBGï¼Ÿ
ä¸ä»…ä»…æ˜¯â€œæŠ½å¡æ‰“ç‰Œâ€ï¼Œå…¶æ ¸å¿ƒåœ¨äº **â€œåŠ¨æ€æ„å»º (Dynamic Construction)â€** ä¸ **â€œéšæœºæ€§ç®¡ç† (Randomness Management)â€** çš„ç»“åˆã€‚
*   **Deckbuilding (DBG)**: ç©å®¶åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­ä¸æ–­å‘ç‰Œåº“æ·»åŠ /ç§»é™¤å¡ç‰Œï¼Œä¼˜åŒ–å¡ç»„ç»“æ„ã€‚
*   **Roguelike**: å•å‘è¿›ç¨‹ã€éšæœºé­é‡ã€æ°¸ä¹…æ­»äº¡ã€‚

### 1.2 æ•°å­¦æ¨¡å‹ï¼šå¾ªç¯ä¸æ¦‚ç‡ (The Math of Cycles)
åœ¨è®¾è®¡æ­¤ç±»æ¸¸æˆæ—¶ï¼Œå‡ ä¸ªå…³é”®çš„æ•°å­¦æŒ‡æ ‡å†³å®šäº†ä½“éªŒçš„åŸºè°ƒï¼š

#### A. ç‰Œåº“å¾ªç¯ç‡ (Deck Cycling Rate)
è¡¡é‡ç©å®¶å¤šä¹…èƒ½é‡æ–°æŠ½åˆ°æ ¸å¿ƒå¡ç‰Œã€‚
$$ CyclingRate = \frac{DrawPerTurn + ExtraDraw}{DeckSize} $$
*   **StS ç»éªŒ**: åˆå§‹å¡ç»„å°ï¼ˆ10-12å¼ ï¼‰ï¼Œæ¯å›åˆæŠ½5å¼ ï¼Œæ„å‘³ç€å¤§æ¦‚2-3å›åˆå°±èƒ½è¿‡ç©¿ä¸€æ¬¡ç‰Œåº“ã€‚è¿™ç§**é«˜é¢‘å¾ªç¯**æ˜¯ç­–ç•¥ç¨³å®šæ€§çš„æ¥æºã€‚
*   **Vampirefall åº”ç”¨**: æˆ‘ä»¬çš„â€œå¡”é˜²å¡ç»„â€å¦‚æœè¿‡å¤§ï¼Œç©å®¶ä¼šä»â€œæ„ç­‘è€…â€å˜æˆâ€œèµŒå¾’â€ã€‚å»ºè®®ä¿æŒå°è€Œç²¾çš„å¡æ± ã€‚

#### B. è¾“å…¥éšæœºæ€§ vs è¾“å‡ºéšæœºæ€§ (Input vs Output Randomness)
*   **è¾“å…¥éšæœºæ€§ (Input)**: ä¸‹ä¸€å›åˆæŠ½åˆ°ä»€ä¹ˆç‰Œï¼Ÿæ€ªç‰©è¦åšä»€ä¹ˆï¼Ÿï¼ˆStS: å·²çŸ¥æ€ªç‰©æ„å›¾ï¼Œå·²çŸ¥æ‰‹ç‰Œï¼‰-> **è¿™æ˜¯ç­–ç•¥ç©ºé—´**ã€‚
*   **è¾“å‡ºéšæœºæ€§ (Output)**: è¿™å¼ å¡æ‰“å‡ºå»é€ æˆ 10-20 ç‚¹ä¼¤å®³ã€‚ï¼ˆStS: å‡ ä¹æ²¡æœ‰ï¼‰-> **è¿™æ˜¯æŒ«è´¥æ„Ÿæ¥æº**ã€‚
*   **ç»“è®º**: å°½å¯èƒ½æ¶ˆé™¤è¾“å‡ºéšæœºæ€§ï¼Œæœ€å¤§åŒ–è¾“å…¥éšæœºæ€§çš„é€æ˜åº¦ã€‚

### 1.3 è®¾è®¡å¿ƒç†å­¦ï¼šæƒè¡¡ä¸åšå¼ˆ
*   **æŸå¤±åŒæ¶ (Loss Aversion)**: ä¸ºä»€ä¹ˆâ€œç§»é™¤ä¸€å¼ ç‰Œâ€å¾€å¾€æ¯”â€œè·å¾—ä¸€å¼ é‡‘å¡â€æ›´å¼ºï¼Ÿå› ä¸ºç²¾ç®€å¡ç»„èƒ½æé«˜æ ¸å¿ƒå¡çš„ä¸Šæ‰‹ç‡ã€‚
*   **ååŒæ•ˆåº” (Synergy)**: 1+1 > 2 çš„å¿«æ„Ÿã€‚ä¾‹å¦‚â€œæ¯’â€æœºåˆ¶ï¼šå æ¯’å±‚æ•° -> ç¿»å€æ¯’å±‚æ•°ã€‚è¿™ç§**æŒ‡æ•°çº§çˆ†å‘**æ˜¯ç©å®¶è¿½æ±‚çš„ç»ˆæå¿«æ„Ÿã€‚

### 1.4 Roguelike å®è§‚å¾ªç¯ (The Macro Loop)
ä¸€ä¸ªæˆç†Ÿçš„ DBG å¾ªç¯ç”±å¾®è§‚ï¼ˆå±€å†…ï¼‰å’Œå®è§‚ï¼ˆå±€å¤–ï¼‰ä¸¤ä¸ªé—­ç¯ç»„æˆï¼š

1.  **å¾®è§‚æˆ˜æ–— (The Encounter)**: æŠ½ç‰Œ -> å†³ç­– -> ç»“ç®— -> æ•Œæ–¹è¡ŒåŠ¨ã€‚
2.  **ä¸­è§‚æ„å»º (The Run)**:
    *   **æˆ˜æ–— (Combat)**: éªŒè¯å½“å‰å¡ç»„å¼ºåº¦ã€‚
    *   **å¥–åŠ± (Reward)**: è·å¾—æ–°å¡/é—ç‰© (é‡‘å¸/å¡ç‰Œ/è¯æ°´)ã€‚
    *   **åˆ å‡ (Removal)**: å»é™¤æ‚è´¨ (å•†åº—/äº‹ä»¶)ã€‚
    *   **å¼ºåŒ– (Upgrade)**: æå‡æ ¸å¿ƒå¡æ•°å€¼ (ç«å †)ã€‚
    *   **å†³ç­– (Routing)**: é€‰æ‹©é£é™©ä¸æ”¶ç›Šçš„è·¯å¾„ (æ‰“ç²¾è‹±è¿˜æ˜¯å›è¡€ï¼Ÿ)ã€‚

### 1.5 æ•°å€¼è†¨èƒ€æ§åˆ¶æ¨¡å‹ (Controlling Power Creep)
DBG æ¸¸æˆçš„ç©å®¶ä¼¤å®³é€šå¸¸å‘ˆ**æŒ‡æ•°çº§å¢é•¿** (Exponential)ï¼Œè€Œä¼ ç»Ÿ RPG æ€ªç‰©è¡€é‡é€šå¸¸æ˜¯**çº¿æ€§å¢é•¿** (Linear)ã€‚ä¸ºäº†é˜²æ­¢æ¸¸æˆåœ¨åæœŸå˜å¾—è¿‡äºå‰²è‰æˆ–ä¸å¯æˆ˜èƒœï¼Œéœ€è¦å¼•å…¥ä»¥ä¸‹æ§åˆ¶æ¨¡å‹ï¼š

*   **æ€ªç‰©è¡€é‡æ›²çº¿ (HP Curve)**: å¿…é¡»é…åˆç©å®¶çš„ååŒæ•ˆåº”è¿›è¡Œ**åˆ†æ®µæŒ‡æ•°å¢é•¿**ã€‚
    *   ç¬¬ä¸€é˜¶æ®µ (çº¿æ€§): Act 1ï¼Œç©å®¶å¡ç»„æœªæˆå‹ã€‚
    *   ç¬¬äºŒé˜¶æ®µ (æŒ‡æ•°): Act 2-3ï¼Œç©å®¶è·å¾—å…³é”®é—ç‰©/Key Cardï¼Œä¼¤å®³çˆ†å‘ã€‚
*   **è½¯ä¸Šé™æœºåˆ¶ (Soft Caps)**:
    *   **ä¼¤å®³ä¸Šé™**: å•æ¬¡ä¼¤å®³ä¸è¶…è¿‡ 999 (å¦‚ StS çš„å¿ƒè„)ã€‚
    *   **æ— æ•Œæœºåˆ¶**: å¼ºåˆ¶é”è¡€æˆ–æ— æ•Œå›åˆ (Time Eater çš„ 12 å¼ ç‰Œé™åˆ¶)ã€‚
*   **æ€ªç‰©ååˆ¶ (Counter-Play)**: ä¸ä»…ä»…åŠ è¡€é‡ï¼Œè€Œæ˜¯é’ˆå¯¹ç‰¹å®šæµæ´¾çš„æœºåˆ¶ã€‚
    *   é’ˆå¯¹é«˜é¢‘æ”»å‡»ï¼šåä¼¤æ€ª (Spiker)ã€‚
    *   é’ˆå¯¹æ— é™æµï¼šæ¯å›åˆå‡ºç‰Œä¸Šé™ (Time Eater)ã€‚
    *   é’ˆå¯¹é«˜çˆ†å‘ï¼šé‡ç”Ÿæˆ–å¤šé˜¶æ®µ (Awakened One)ã€‚

---

## ğŸ› ï¸ 2. å®è·µåº”ç”¨ (Practical Implementation)

### 2.1 Vampirefall é€‚é…ç­–ç•¥
æœ¬é¡¹ç›®æ˜¯ **å¡”é˜² + è‚‰é¸½**ï¼Œå¡ç‰Œä¸ä»…æ˜¯â€œæ”»å‡»æŒ‡ä»¤â€ï¼Œæ›´æ˜¯â€œèµ„æºåˆ†é…â€ã€‚

*   **å¡ç‰Œç±»å‹**:
    *   **ç¬é—´å‹ (Instant)**: ç±»ä¼¼äºæ³•æœ¯ï¼Œç›´æ¥å¯¹åœºä¸Šæ€ªç‰©é€ æˆä¼¤å®³/æ§åˆ¶ (e.g., ç«çƒæœ¯, å†»ç»“)ã€‚
    *   **ç”±äºå‹ (Persistent)**: æ”¾ç½®ä¸€åº§ä¸´æ—¶é˜²å¾¡å¡”ï¼Œæˆ–ç»™äºˆé˜²å¾¡å¡”ä¸€ä¸ªæŒç»­ 30s çš„ Buffã€‚
    *   **ç»æµå‹ (Economy)**: ç‰ºç‰²å½“å‰æˆ˜åŠ›æ¢å–é•¿è¿œæ”¶ç›Š (e.g., çŒ®ç¥­ä¸€åº§å¡”è·å¾—é‡‘å¸)ã€‚

### 2.2 æ•°æ®ç»“æ„ (C# Data Structures)
ä½¿ç”¨ **ScriptableObject** æ„å»ºé«˜åº¦æ¨¡å—åŒ–çš„å¡ç‰Œç³»ç»Ÿã€‚

```csharp
// æ ¸å¿ƒå¡ç‰Œå®šä¹‰
[CreateAssetMenu(fileName = "NewCard", menuName = "Vampirefall/Card")]
public class CardData : ScriptableObject {
    public string id;
    public string cardName;
    public int energyCost;
    public CardType type;
    public Sprite artwork;
    public List<CardEffect> effects; // æ•ˆæœé“¾
}

// æ•ˆæœå®šä¹‰ï¼ˆç­–ç•¥æ¨¡å¼ï¼‰
public abstract class CardEffect : ScriptableObject {
    public abstract void Execute(BattleContext context);
    public abstract string GetDescription();
}

// å…·ä½“æ•ˆæœç¤ºä¾‹ï¼šé€ æˆä¼¤å®³
public class EffectDealDamage : CardEffect {
    public int baseDamage;
    public DamageType damageType;
    
    public override void Execute(BattleContext context) {
        // è®¡ç®—æœ€ç»ˆä¼¤å®³ï¼ˆå«é—ç‰©/BuffåŠ æˆï¼‰
        int finalDmg = DamageCalculator.Calculate(baseDamage, context.Source, context.Target);
        context.Target.TakeDamage(finalDmg);
    }
}
```

### 2.3 æ ¸å¿ƒæ¶æ„ï¼šå‘½ä»¤é˜Ÿåˆ—ç³»ç»Ÿ (Command Queue System)
ä¸ºäº†è§£å†³å¤æ‚çš„ç»“ç®—é¡ºåºï¼ˆä¾‹å¦‚ï¼šæ‰“å‡ºä¸€å¼ ç‰Œ -> è§¦å‘é—ç‰©A -> è§¦å‘æ€ªç‰©è¢«åŠ¨B -> è§¦å‘é—ç‰©Cï¼‰ï¼Œå‚è€ƒ StS é‡‡ç”¨ **å‘½ä»¤é˜Ÿåˆ—æ¨¡å¼**ã€‚

*   **ActionManager**: ç»´æŠ¤ä¸€ä¸ª `Queue<GameAction>`ã€‚
*   **GameAction**: æ‰€æœ‰æ¸¸æˆè¡Œä¸ºçš„åŸºç±»ï¼ˆæŠ½ç‰Œã€é€ æˆä¼¤å®³ã€è·å¾—æ ¼æŒ¡ã€ç­‰å¾…ï¼‰ã€‚
*   **æ‰§è¡Œæµç¨‹**:
    1.  ç©å®¶æ‰“å‡ºå¡ç‰Œ -> ç”Ÿæˆå¤šä¸ª Actions å…¥é˜Ÿã€‚
    2.  é˜Ÿåˆ—ä¾æ¬¡ `Update()` ç›´åˆ°å®Œæˆ (`isDone`).
    3.  è‹¥ Action è§¦å‘äº†æ–°äº‹ä»¶ï¼ˆå¦‚å—ä¼¤è§¦å‘åå‡»ï¼‰ï¼Œå°†æ–° Action **æ’å…¥é˜Ÿé¦– (AddToTop)** æˆ– **é˜Ÿå°¾ (AddToBottom)**ã€‚

#### ä¼ªä»£ç é€»è¾‘
```csharp
class ActionManager {
    private List<GameAction> actions = new List<GameAction>();

    void Update() {
        if (actions.Count > 0) {
            var current = actions[0];
            if (!current.hasStarted) current.Start();
            current.Update();
            if (current.isDone) actions.RemoveAt(0);
        }
    }
    
    void AddToBottom(GameAction action) { actions.Add(action); }
    void AddToTop(GameAction action) { actions.Insert(0, action); }
}
```

---

## ğŸŒŸ 3. ä¸šç•Œä¼˜ç§€æ¡ˆä¾‹ (Industry Best Practices)

### 3.1 Slay the Spire (æ€æˆ®å°–å¡”)
*   **ä¼˜ç‚¹**:
    *   **æ„å›¾ç³»ç»Ÿ (Intent System)**: æå…¶æ¸…æ™°çš„ä¿¡æ¯å±•ç¤ºï¼Œå®Œå…¨æ¶ˆé™¤äº†â€œæœªçŸ¥å¸¦æ¥çš„ææƒ§â€ï¼Œè®©ç©å®¶ä¸“æ³¨äºè§£é¢˜ã€‚
    *   **é—ç‰©ç³»ç»Ÿ (Relics)**: æ”¹å˜æ¸¸æˆè§„åˆ™çš„è¢«åŠ¨é“å…·ï¼Œæå¤§ä¸°å¯Œäº†é‡ç©ä»·å€¼ã€‚
*   **å€Ÿé‰´ç‚¹**: æˆ‘ä»¬å¿…é¡»åœ¨ UI ä¸Šæ˜ç¡®æ˜¾ç¤ºä¸‹ä¸€æ³¢æ•Œäººçš„æ„å›¾ï¼ˆæ”»å‡»å“ªä¸ªå¡”ï¼Ÿèµ°å“ªæ¡è·¯ï¼Ÿï¼‰ã€‚

### 3.2 Monster Train (æ€ªç‰©ç«è½¦)
*   **ä¼˜ç‚¹**:
    *   **ä¸‰å±‚é˜²çº¿**: å°†æˆ˜åœºåˆ†ä¸ºä¸‰å±‚ï¼Œå¢åŠ äº†ç©ºé—´ç­–ç•¥ç»´åº¦ã€‚
    *   **è‹±é›„å‡çº§**: æ ¸å¿ƒå•ä½ï¼ˆChampionï¼‰æœ‰å¤šæ¡å‡çº§è·¯çº¿ã€‚
*   **å€Ÿé‰´ç‚¹**: Vampirefall çš„å¡”é˜²åœ°å›¾æœ¬èº«å°±æ˜¯å¤šå±‚/å¤šè·¯å¾„çš„ï¼Œå¯ä»¥å€Ÿé‰´å…¶â€œé˜²çº¿å´©æºƒåé€€å®ˆä¸‹ä¸€å±‚â€çš„æ¦‚å¿µã€‚

### 3.3 Inscryption (é‚ªæ¶å†¥åˆ»)
*   **ä¼˜ç‚¹**:
    *   **å™äº‹ç»“åˆ**: æ‰“ç‰Œä¸ä»…ä»…æ˜¯æ‰“ç‰Œï¼Œè¿˜æ˜¯åœ¨ä¸ DM (Dungeon Master) åšå¼ˆã€‚
    *   **ç‰ºç‰²æœºåˆ¶**: å¿…é¡»çŒ®ç¥­å¼±å°ç”Ÿç‰©æ‰èƒ½å¬å”¤å¼ºå¤§ç”Ÿç‰©ã€‚
*   **å€Ÿé‰´ç‚¹**: æˆ‘ä»¬çš„â€œå›æ”¶å¡”â€æœºåˆ¶å¯ä»¥å‚è€ƒç‰ºç‰²ç³»ç»Ÿâ€”â€”å›æ”¶ä¸€åº§ä½çº§å¡”ï¼Œä½œä¸ºå¬å”¤é«˜çº§å¡”çš„èµ„æºã€‚

---

## ğŸ”— 4. å‚è€ƒèµ„æ–™ (References)
*   ğŸ“º **GDC**: [Slay the Spire: Metrics Driven Design and Balance](https://www.youtube.com/watch?v=0pLPlQ81iWo) (å¼ºçƒˆæ¨èï¼šæ•°å€¼å¹³è¡¡æ–¹æ³•è®º)
*   ğŸ“º **GDC**: [The 10 Year Journey of Slay the Spire](https://www.youtube.com/watch?v=JmwcYqtsUj0)
*   ğŸ“„ **Blog**: [The Design of Slay the Spire](https://www.gamedeveloper.com/design/the-design-of-slay-the-spire)
*   ğŸŒ **Wiki**: [Slay the Spire Wiki - Mechanics](https://slay-the-spire.fandom.com/wiki/Slay_the_Spire_Wiki)
