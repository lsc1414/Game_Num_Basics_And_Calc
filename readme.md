📘 核心数值体系定义手册 (通用文本版)

适用范围： 塔防 + 肉鸽 + 刷宝
设计参考： Path of Exile (PoE), Diablo 4, Warframe
说明： 本版本已移除 LaTeX 公式，适配所有文档平台。

1. ⚔️ 伤害计算总公式 (The Golden Damage Formula)

这是整个游戏最核心的公式。所有伤害计算必须遵循此逻辑，严禁随意添加乘区。

最终伤害 = 输出面板 (Outgoing) × 防御减伤系数 (DefMitigation)

其中 输出面板 的计算逻辑如下：

Outgoing = [基础伤害] × [增伤乘区] × [独立乘区] × [暴击乘区]

展开公式：
Outgoing = [(面板攻击 × 技能倍率) + 技能固定伤] × (1 + Inc总和) × (1 + MoreA) × (1 + MoreB)... × 暴击倍率

1.1 🧱 基础伤害的构成

公式： 基础伤害 = (面板攻击 × 技能系数) + 技能固定伤害

💪 面板攻击 (Panel ATK):

来源：角色基础 + 武器攻击 + 装备附加点伤(Flat)。

定义：代表角色“平A”一下的理论强度。

🔧 技能系数 (Skill Ratio):

来源：技能配置表。

示例：普攻 100%，强力一击 250%，多重箭 60% x 3。

🎁 技能固定伤害 (Skill Flat):

来源：技能等级成长（如：火球术造成 200% ATK + 500 点伤害）。

作用：保底机制，平衡前期体验。

1.2 🎛️ 参数详解

➕ 增伤 (Inc / Additive) —— A类增伤

公式： (1 + 物理伤% + 全伤% + 远程伤% + ...)

定义： 所有的 Inc 词条相加。

包含： 物理伤害%、远程伤害%、全伤害%、火焰伤害%、对流血敌人伤害%。

陷阱： 边际收益递减严重。

✖️ 独立倍率 (More / Multiplicative) —— B类增伤

公式： × (1 + More A) × (1 + More B) ...

定义： 每一个 More 词条都是一个独立的乘区。

包含： 易伤状态、终极天赋效果。

1.3 📝 实战计算案例

假设玩家属性如下：

面板攻击: 200

技能: 幻影斩 (系数 1.5, 固定伤 50)

词条: 物理+20%, 近战+30%

独立增伤: 1.2 (天赋)

暴击: 2.0 (爆伤)

计算过程：

基础区间: (200 × 1.5) + 50 = 350

增伤区间: 1 + 0.2 + 0.3 = 1.5 倍

最终输出: 350 × 1.5 × 1.2 × 2.0 = 1260

1.4 ⚖️ 暴击稳定性 (PRD)

为了防止“连续不暴击”导致漏怪，慢速武器强制使用伪随机 (PRD) 算法。

2. ⚡ 速度、动画与冷却

2.1 🗡️ 攻击速度 (APS)

定义： 每秒攻击次数 (Attacks Per Second)。

公式： 最终攻速 = 基础攻速 × (1 + 攻速加成%)

避坑： 不要使用“攻击间隔”作为属性，会导致数值崩坏。

2.2 ⏳ 冷却缩减 (CDR)

公式： 最终CD = 基础CD × (1 - min(CDR, 上限))

建议上限： 75% (即 4倍频率)。

3. 🎯 射程与弹道

3.1 🗼 静态塔逻辑

射程 (Range): 同时代表 索敌半径 和 子弹最大飞行距离。

3.2 🚀 弹道与寿命公式

问题： 为什么子弹会半路消失？

公式： 子弹寿命 = (射程 / 弹速) × 1.5

说明： 乘以 1.5 是为了提供追击冗余 (Buffer)，防止怪在边缘逃跑时子弹打空。

3.3 🛰️ 特殊弹道

A. 地雷模式: 速度=0，寿命=起爆时间。

B. 追踪模式: 引入 转向速度 (TurnRate) 和 引导延迟 (GuidanceDelay)。

4. 🛡️ 防御属性系统

4.1 ⚙️ 物理防御：护甲 (Armor)

公式： 物理减伤率 = 护甲 / (护甲 + 常数K)

常数K: 建议取值 3000。

特性： 虽然减伤百分比递减，但有效生命值 (EHP) 是线性增长的。

4.2 🔥 元素防御：抗性与穿透

公式： 元素系数 = 1 - min((目标抗性 - 攻击者穿透), 75%)

抗性上限: 必须锁定为 75%（或 90%），防止免疫。

4.3 💨 闪避系统 (Dodge)

机制： 完全免伤。必须使用 伪随机 (PRD) 算法。

风险： 闪避收益是指数级的（90% -> 99% 收益翻10倍），必须设置硬上限（如 75%）。

5. 🌊 溢出转化系统

暴击溢出 (>100%): 转为爆伤或红色暴击（双倍爆伤）。

攻速溢出 (>10/s): 转为多重射击 (Multishot)，保护显卡。

6. 🖥️ UI 面板显示标准

DPS (秒伤): 显示综合了攻速、暴击后的期望值。格式 {N0} (如 12,450)。

攻速: 显示 {N2}/s (如 1.50/s)，不要显示间隔时间。

有效生命 (EHP): HP / ((1-减伤) * (1-闪避))，放在高级面板中。

7. 💪 战力计算标准 (Combat Power)

公式： 战力 = ∑(属性值 × 权重) + ∑(机制分)

权重参考 (1攻 = 1分):

攻击力: 1.0

生命值: 0.2

暴击率%: 15.0

CDR%: 20.0

独立增伤%: 25.0 (最珍贵)

投射物+1: 固定 500 分

8. 🎲 伪随机分布 (PRD) 算法

核心逻辑： P(N) = C × N

N: 失败次数。C: 概率常数。

每次失败，下一次几率增加 C。成功后重置。

C值速查表:

10% 几率 -> C = 0.014

25% 几率 -> C = 0.084

50% 几率 -> C = 0.302

9. 🍀 掉落与平衡

9.1 权重预算制 (蓄水池)

痛点： 怪多的时候掉落太多卡顿。

方案： 怪物死亡不直接掉落，而是给“蓄水池”充能。池满 (如 1000点) 则强制掉落一次。

效果： 无论场上怪多少，每分钟掉落数量 (DPM) 恒定可控。

9.2 冷启动对策

预填充: 关卡开始时，蓄水池直接填充 80%，保证第一个精英怪必掉装备。

10. ♾️ 无尽模式成长模型

10.1 动态替补

设置同屏硬上限 (如 200)。当怪少于 200 时才生成新怪，制造“无穷无尽”的假象，但保护性能。

10.2 数值成长公式

HP成长: 基础HP × 1.2 ^ (波次)

攻击成长: 基础ATK × 1.1 ^ (波次)

说明: 血量是指数增长的，必须给玩家提供指数级的伤害提升手段（如独立乘区）。

11. 🔮 进阶属性

格挡 (Block): 拥有“格挡率”和“格挡减伤”两个参数。比护甲更强的生存手段。

多重施法 (Multicast): 几率额外触发一次攻击。溢出 100% 的部分判定第 3 次攻击。

斩杀 (Cull): 低于 10% 血量直接秒杀。

12. 💡 设计原理 (FAQ)

12.1 ⚗️ 数值膨胀的核心机制：加法、乘法与独立乘区

这是所有刷宝游戏（如 D4, PoE）的数值基石，也是控制玩家伤害不至于失控（或过弱）的关键。我们采用 “乘区理论 (Bucket Theory)” 来构建伤害体系。

A. 加法 (Additive / Inc) —— "同类稀释"

定义: 绝大多数词条都属于这一类（如：全伤害+、物理伤害+、近战伤害+）。

机制: 所有的 "Inc" 词条会被扔进同一个“大桶”里做加法，然后再参与最终乘算。

稀释效应 (Dilution):

假设你已有 +400% 增伤。

再获得一个 "+50% 物理伤害" 词条。

实际提升: $(1 + 4.5) / (1 + 4.0) = 5.5 / 5.0 = 1.1$ (即 10% 提升)。

结论: 同样数值的词条，你拥有的越多，新获得的那个就越不值钱。

设计目的: 作为数值的基石。保证玩家前期有明显的成长，但防止后期数值指数级爆炸。

B. 乘法 (Multiplicative / More) —— "独立增益"

定义: 描述中通常带有“额外”、“总伤害”字样的稀有词条。

机制: 每一个 More 词条都是一个独立的桶。它直接乘在最终伤害上。

多源叠加规则: 不同来源的 More 增伤是分开乘算的。

公式: TotalMore = (1 + MoreA) * (1 + MoreB) * (1 + MoreC)

示例: 天赋20% More，装备30% More -> 1.2 * 1.3 = 1.56 (56% 提升)，而非 50%。

注意: 同一来源的堆叠（如: 3层狂暴状态，每层10% More）通常是先加后乘 (1 + 3*10%)，具体视游戏机制而定。

无稀释:

无论你现在有多少增伤，获得一个 "额外造成 20% 伤害" 的词条。

实际提升: 实打实的 20%。

设计目的: 作为诱饵。引导玩家去追求特定的构建（Build），因为它是质变属性。

C. 独立乘区 (Independent Buckets) —— "维度攻击"

除了上述的 Inc 和 More，还有一些天然的独立乘区。一个成熟的 BD (Build) 会尝试在所有乘区上都拿一点分，而不是死磕一个。

乘区名称

作用原理

提升公式

基础区

技能倍率、点伤

直接增加底数

增伤区

Inc 词条

× (1 + Inc总和)

攻速区

攻击频率

× APS

暴击区

双倍伤害

× (1 + Rate × (Dmg - 1))

易伤区

敌人受到的伤害

× (1 + EnemyTaken%)

抗性区

穿透与减抗

× (1 - (Res - Pen))

黄金法则: 2 × 2 × 2 = 8，而 4 × 1 × 1 = 4。

指导意义: 当玩家觉得“伤害刮痧”时，不要让他再去堆攻击力了（稀释严重），引导他去堆攻速、暴击或穿透（开辟新乘区）。

12.2 🛡️ 为什么防御公式要用除法 (百分比减伤)?

A: 减法公式会导致“不破防”或“被秒杀”。除法公式保证 EHP 线性增长。

12.3 🎲 为什么要用伪随机 (PRD)?

A: 消除“脸黑”带来的极差体验（如连续不暴击导致漏怪）。

12.4 🛁 为什么要用蓄水池做掉落控制?

A: 为了保证 DPM (Drops Per Minute) 恒定，解决怪海导致的掉落溢出。

12.5 ⚡ 为什么攻速 (APS) 不能定义为攻击间隔?

A: 攻击间隔减少带来的收益是指数爆炸的。APS 保证线性收益。
