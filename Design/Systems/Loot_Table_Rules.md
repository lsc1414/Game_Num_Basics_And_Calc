# ğŸ’° æ‰è½è§„åˆ™ä¸æˆ˜åˆ©å“ç³»ç»Ÿ (Loot Table Rules)

æœ¬æ–‡æ¡£å®šä¹‰äº†æ€ªç‰©æ­»äº¡æˆ–å®ç®±å¼€å¯æ—¶ï¼Œç”Ÿæˆæˆ˜åˆ©å“çš„ç®—æ³•ã€‚æ ¸å¿ƒç›®æ ‡æ˜¯å¹³è¡¡â€œæƒŠå–œæ„Ÿâ€ä¸â€œç»æµç¨³å®šâ€ã€‚

---

## 1. æ‰è½é¢„ç®—ç³»ç»Ÿ (Drop Budget System)

ä¸ºäº†é˜²æ­¢å‰²è‰æ¸¸æˆä¸­æˆåƒä¸Šä¸‡çš„æ€ªç‰©å¯¼è‡´æ»¡åœ°åƒåœ¾ï¼ˆæ€§èƒ½æ€æ‰‹+è§†è§‰æ±¡æŸ“ï¼‰ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨â€œæ¯åªæ€ªå•ç‹¬Rollç‚¹â€çš„é€»è¾‘ã€‚

### 1.1 è“„æ°´æ± æœºåˆ¶ (The Bucket)
*   ç©å®¶å‡»æ€æ€ªç‰©æ—¶ï¼Œä¸ç›´æ¥æ‰è½ç‰©å“ï¼Œè€Œæ˜¯ç´¯ç§¯ **[æ‰è½ç‚¹æ•° (Drop Points)]**ã€‚
*   `Points += MonsterRarity * PlayerMF`ã€‚
*   å½“ `Points >= Threshold` æ—¶ï¼Œè§¦å‘ä¸€æ¬¡çœŸå®çš„æ‰è½åˆ¤å®š (Roll)ã€‚
*   **ä¼˜åŠ¿:** æ€ 100 åªå°æ€ªå’Œæ€ 1 åªç²¾è‹±æ€ªï¼Œæœ€ç»ˆæœŸæœ›æ”¶ç›Šä¸€è‡´ï¼Œä¸”é¿å…äº†åŒå±å‡ ç™¾ä¸ªç‰©å“æ¸²æŸ“ã€‚

## 2. æ‰è½è¡¨ç»“æ„ (Loot Table Structure)

æ‰è½è¡¨æ˜¯åˆ†å±‚åµŒå¥—çš„ã€‚

*   **Master Table (å…¨å±€è¡¨):**
    *   -> `Currency` (é€šè´§): 30%
    *   -> `Equipment` (è£…å¤‡): 20%
    *   -> `Consumables` (æ¶ˆè€—å“): 10%
    *   -> `Nothing` (ç©ºæ°”): 40%

*   **Sub-Table: Equipment:**
    *   -> `Weapon`: 40%
    *   -> `Armor`: 40%
    *   -> `Jewelry`: 20%

## 3. æ™ºèƒ½æ‰è½ (Smart Loot)

ä¸ºäº†å‡å°‘åƒåœ¾æ—¶é—´ï¼Œç³»ç»Ÿä¼šæ ¹æ®ç©å®¶å½“å‰èŒä¸š/å±æ€§å¾®è°ƒæ‰è½ã€‚

*   **æœºåˆ¶:** æ¯æ¬¡æ‰è½è£…å¤‡æ—¶ï¼Œæœ‰ **15%** çš„æ¦‚ç‡è§¦å‘ Smart Lootã€‚
*   **æ•ˆæœ:**
    1.  **åº•æé€‚é…:** å¿…å®šæ‰è½å½“å‰è§’è‰²å¯ç”¨çš„æ­¦å™¨ç±»å‹ï¼ˆå¦‚æ³•å¸ˆä¸æ‰å¤§æ–§ï¼‰ã€‚
    2.  **ä¸»å±æ€§é”å®š:** å¿…å®šåŒ…å«è§’è‰²çš„ä¸»å±æ€§ï¼ˆå¦‚æ³•å¸ˆè£…å¤‡å¿…å¸¦æ™ºåŠ›ï¼‰ã€‚
*   *æ³¨æ„:* æ¯”ä¾‹ä¸èƒ½å¤ªé«˜ (15-20%)ï¼Œå¦åˆ™ç©å®¶æ— æ³•ä¸ºå…¶ä»–å°å·ç§¯ç´¯è£…å¤‡ï¼Œå¤±å»äº†â€œåˆ·å®ç»™å°å·â€çš„ä¹è¶£ã€‚

## 4. ç‰©å“è¿‡æ»¤ä¸è‡ªåŠ¨æ‹¾å– (Filter & Auto-Loot)

*   **è‡ªåŠ¨æ‹¾å–:** é‡‘å¸ã€ææ–™ (Scrap) ç­‰éå ç”¨èƒŒåŒ…æ ¼å­çš„èµ„æºï¼ŒèŒƒå›´å†…è‡ªåŠ¨å¸é™„ã€‚
*   **è£…å¤‡è¿‡æ»¤:** å…è®¸ç©å®¶è®¾ç½® Loot Filterã€‚
    *   *è§„åˆ™:* `Hide Normal Items`, `Show Legendary`, `Highlight 'Fire Damage'`.
    *   è¢«è¿‡æ»¤çš„ç‰©å“åœ¨æ‰è½æ—¶**ä¸æ¸²æŸ“æ¨¡å‹**ï¼Œä¹Ÿä¸æ’­æ”¾éŸ³æ•ˆï¼Œæå¤§èŠ‚çœæ€§èƒ½ã€‚

## 5. å®ç®±ç±»å‹ (Chest Types)

*   **æ™®é€šå®ç®±:** æ ‡å‡†æ‰è½è¡¨ã€‚
*   **åä¸½å®ç®± (Ornate):** å¿…å®šæ‰è½è‡³å°‘ä¸€ä»¶ç¨€æœ‰ (Rare) è£…å¤‡ã€‚
*   **å†›ç«åº“ (Arsenal):** åªæ‰è½æ­¦å™¨ã€‚
*   **å¥¥æœ¯ä¿é™©ç®± (Arcane Strongbox):** å—åˆ°æ€ªç‰©å®ˆæŠ¤ã€‚å¼€å¯æ—¶å¹¶åœ¨å‘¨å›´ç”Ÿæˆä¸€æ³¢ç²¾è‹±æ€ªã€‚æ¸…å®Œæ€ªåæ‰è½å¤§é‡é€šè´§ã€‚

---

## 6. ç®—æ³•ä¼ªä»£ç  (Algorithm)

```python
def OnMonsterDie(monster, player):
    # 1. ç´¯ç§¯é¢„ç®—
    player.DropBucket += monster.DropValue * (1 + player.ItemRarity)
    
    # 2. æ£€æŸ¥é˜ˆå€¼
    if player.DropBucket >= DROP_THRESHOLD:
        player.DropBucket -= DROP_THRESHOLD
        
        # 3. æ‰§è¡Œæ‰è½
        LootItem item = RollLootTable(monster.Level)
        
        # 4. æ™ºèƒ½æ‰è½ä¿®æ­£
        if Random() < 0.15:
            item = ApplySmartLoot(item, player.Class)
            
        SpawnItemWorldObject(item, monster.Position)
```
